const BG_API_KEYS=["G6nRerni4niQACNWuWg7Kvi1","UxybaW3vfo8j4wZfXbvo3ajP","VAnV2Qwn7GncCJBgVwVMTK2J","d1QDMnVQCwxqdyhYXRVRBW33"];function openBgRemoverModal(){"function"==typeof setActiveMode&&setActiveMode("mode-bg-remover");var e=document.getElementById("bgRemoverModal");e&&(e.style.display="flex",document.body.style.overflow="hidden")}function closeBgRemoverModal(){var e=document.getElementById("bgRemoverModal");e&&(e.style.display="none",document.body.style.overflow="auto",document.getElementById("bgResultArea").style.display="none",document.getElementById("bgInput").value="",document.getElementById("bgFileName").innerText="Select or Drag Image")}async function processBgRemoval(){let e=document.getElementById("bgInput"),t=e.files[0],n=document.getElementById("bgRemoveBtn"),o=document.getElementById("bgLoader"),i=document.getElementById("bgResultArea"),a=document.getElementById("bgResultImage"),l=document.getElementById("bgDownloadLink");if(!t){"function"==typeof showAlert?showAlert("Please select an image first!"):alert("Please select an image first!");return}n.disabled=!0,n.innerHTML='<i class="fa-solid fa-spinner fa-spin"></i> Processing AI...',o.style.display="block",i.style.display="none";let r=new FormData;r.append("image_file",t),r.append("size","auto");let s=[...BG_API_KEYS].sort(()=>Math.random()-.5),d=!1,y="Server error. Please try again.";for(let g=0;g<s.length;g++){let m=s[g];console.log("Trying API Key: "+(g+1));try{let c=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":m},body:r});if(402===c.status){console.warn("Credit limit reached for key "+(g+1)+". Trying next..."),y="API limit reached. Trying backup systems...";continue}if(403===c.status){console.error("Invalid API Key found at index: "+g);continue}if(!c.ok){y="Server is busy. Trying backup...";continue}let f=await c.blob(),b=URL.createObjectURL(f);a.src=b,l.href=b,i.style.display="block",d=!0;break}catch(u){console.error("Network error with key "+(g+1)),y="Connection error. Retrying..."}}d?i.scrollIntoView({behavior:"smooth"}):"function"==typeof showAlert?showAlert("All API limits reached or connection failed. Please add more keys or wait for next month."):alert(y),n.disabled=!1,n.innerHTML='<i class="fa-solid fa-wand-magic-sparkles"></i> Remove Background',o.style.display="none"}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("bgInput");e&&e.addEventListener("change",function(){this.files&&this.files[0]&&(document.getElementById("bgFileName").innerText=this.files[0].name)})});
